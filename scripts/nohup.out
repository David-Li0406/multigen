[09/10/2021 13:41:22 - WARNING - root] Process rank: -1, device: cuda, n_gpu: 2, distributed training: False, 16-bits training: False
[09/10/2021 13:41:22 - INFO - transformers.tokenization_utils] Model name '../models/gpt2-small' not found in model shortcut name list (gpt2, gpt2-medium, gpt2-large, distilgpt2). Assuming '../models/gpt2-small' is a path, a model identifier, or url to a directory containing tokenizer files.
[09/10/2021 13:41:22 - INFO - transformers.tokenization_utils] Didn't find file ../models/gpt2-small/added_tokens.json. We won't load it.
[09/10/2021 13:41:22 - INFO - transformers.tokenization_utils] Didn't find file ../models/gpt2-small/special_tokens_map.json. We won't load it.
[09/10/2021 13:41:22 - INFO - transformers.tokenization_utils] Didn't find file ../models/gpt2-small/tokenizer_config.json. We won't load it.
[09/10/2021 13:41:22 - INFO - transformers.tokenization_utils] loading file ../models/gpt2-small/vocab.json
[09/10/2021 13:41:22 - INFO - transformers.tokenization_utils] loading file ../models/gpt2-small/merges.txt
[09/10/2021 13:41:22 - INFO - transformers.tokenization_utils] loading file None
[09/10/2021 13:41:22 - INFO - transformers.tokenization_utils] loading file None
[09/10/2021 13:41:22 - INFO - transformers.tokenization_utils] loading file None
[09/10/2021 13:41:22 - INFO - transformers.configuration_utils] loading configuration file ../models/gpt2-small/config.json
[09/10/2021 13:41:22 - INFO - transformers.configuration_utils] Model config GPT2Config {
  "_num_labels": 2,
  "activation_function": "gelu_new",
  "architectures": [
    "GPT2LMHeadModel"
  ],
  "attn_pdrop": 0.1,
  "bad_words_ids": null,
  "bos_token_id": 50256,
  "decoder_start_token_id": null,
  "do_sample": false,
  "early_stopping": false,
  "embd_pdrop": 0.1,
  "eos_token_id": 50256,
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "is_encoder_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_epsilon": 1e-05,
  "length_penalty": 1.0,
  "max_length": 20,
  "min_length": 0,
  "model_type": "gpt2",
  "n_ctx": 1024,
  "n_embd": 768,
  "n_head": 12,
  "n_layer": 12,
  "n_positions": 1024,
  "no_repeat_ngram_size": 0,
  "num_beams": 1,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": null,
  "prefix": null,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "resid_pdrop": 0.1,
  "summary_activation": null,
  "summary_first_dropout": 0.1,
  "summary_proj_to_labels": true,
  "summary_type": "cls_index",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 50
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "use_bfloat16": false,
  "vocab_size": 50257
}

[09/10/2021 13:41:22 - INFO - transformers.modeling_utils] loading weights file ../models/gpt2-small/pytorch_model.bin
[09/10/2021 13:41:27 - INFO - modeling_gpt2] Tie weights in head!!!!!
[09/10/2021 13:41:27 - INFO - modeling_gpt2] Tie weights in head!!!!!
[09/10/2021 13:41:28 - INFO - transformers.modeling_utils] Weights of MultiHopGen not initialized from pretrained model: ['W_r.0.weight', 'W_n.1.weight', 'W_n.0.weight', 'gate_linear.bias', 'lm_head.weight', 'W_s.1.weight', 'gate_linear.weight', 'W_r.1.weight', 'triple_linear.weight', 'W_s.0.weight', 'relation_embd.weight']
[09/10/2021 13:41:28 - INFO - modeling_gpt2] Tie weights in head!!!!!
[09/10/2021 13:41:29 - INFO - modeling_gpt2] Tie weights in head!!!!!
[09/10/2021 13:41:33 - INFO - root] ----------------------------------------------------------------------------------------------------
[09/10/2021 13:41:33 - INFO - root] CONFIG:
{
    "adam_epsilon": 1e-08,
    "aggregate_method": "max",
    "alpha": 3.0,
    "beta": 5.0,
    "dev_data_file": "../data/DG_oxford5.0/dev",
    "device": "cuda",
    "do_eval": false,
    "do_generate": false,
    "do_train": true,
    "evaluate_metrics": "bleu",
    "fp16": false,
    "fp16_opt_level": "O1",
    "gamma": 0.5,
    "gradient_accumulation_steps": 1,
    "graph_path": "2hops_100_directed_triple_filter.json",
    "learning_rate": 1e-05,
    "local_rank": -1,
    "logging_steps": 20,
    "max_grad_norm": 1.0,
    "max_steps": -1,
    "model_name_or_path": "../models/gpt2-small",
    "model_type": "gpt2",
    "n_gpu": 2,
    "no_cuda": false,
    "num_train_epochs": 3,
    "output_dir": "../models/DG_oxford5.0/grf-DG_oxford5.0",
    "overwrite_cache": false,
    "overwrite_output_dir": true,
    "per_gpu_eval_batch_size": 32,
    "per_gpu_train_batch_size": 32,
    "save_last": false,
    "seed": 42,
    "server_ip": "",
    "server_port": "",
    "source_length": 110,
    "target_length": 110,
    "tb_log_dir": null,
    "test_data_file": "../data/DG_oxford5.0/test",
    "train_data_file": "../data/DG_oxford5.0/train",
    "validate_steps": 700,
    "warmup_ratio": 0.0,
    "weight_decay": 0.0,
    "workers": 7
}
[09/10/2021 13:41:33 - INFO - root] ----------------------------------------------------------------------------------------------------
[09/10/2021 13:42:38 - INFO - root] --------------------------------------------------Features--------------------------------------------------
[09/10/2021 13:42:38 - INFO - root] Input: ['<|bos|>', 'config', 'ure', '<|sep|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|bos|>', 'config', 'ure', '<|sep|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>']
[09/10/2021 13:42:38 - INFO - root] Attention mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
[09/10/2021 13:42:38 - INFO - root] Position: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
[09/10/2021 13:42:38 - INFO - root] Target: ['<|bos|>', 'Ġarrange', 'Ġor', 'Ġput', 'Ġtogether', 'Ġin', 'Ġa', 'Ġparticular', 'Ġform', 'Ġor', 'Ġconfiguration', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>']
[09/10/2021 13:42:38 - INFO - root] Position: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
[09/10/2021 13:42:38 - INFO - root] Labels: ['Ġarrange', 'Ġor', 'Ġput', 'Ġtogether', 'Ġin', 'Ġa', 'Ġparticular', 'Ġform', 'Ġor', 'Ġconfiguration', '<|endoftext|>']
[09/10/2021 13:42:38 - INFO - root] Gate labels: [-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1]
[09/10/2021 13:42:38 - INFO - root] Input: ['<|bos|>', 'config', 'ure', '<|sep|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|bos|>', 'config', 'ure', '<|sep|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>']
[09/10/2021 13:42:38 - INFO - root] Attention mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
[09/10/2021 13:42:38 - INFO - root] Position: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
[09/10/2021 13:42:38 - INFO - root] Target: ['<|bos|>', 'Ġarrange', 'Ġor', 'Ġorder', 'Ġ(', 'Ġa', 'Ġcomputer', 'Ġsystem', 'Ġor', 'Ġan', 'Ġelement', 'Ġof', 'Ġit', 'Ġ)', 'Ġso', 'Ġas', 'Ġto', 'Ġfit', 'Ġit', 'Ġfor', 'Ġa', 'Ġdesignated', 'Ġtask', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>']
[09/10/2021 13:42:38 - INFO - root] Position: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
[09/10/2021 13:42:38 - INFO - root] Labels: ['Ġarrange', 'Ġor', 'Ġorder', 'Ġ(', 'Ġa', 'Ġcomputer', 'Ġsystem', 'Ġor', 'Ġan', 'Ġelement', 'Ġof', 'Ġit', 'Ġ)', 'Ġso', 'Ġas', 'Ġto', 'Ġfit', 'Ġit', 'Ġfor', 'Ġa', 'Ġdesignated', 'Ġtask', '<|endoftext|>']
[09/10/2021 13:42:38 - INFO - root] Gate labels: [-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1]
[09/10/2021 13:42:38 - INFO - root] Input: ['<|bos|>', 'col', 'on', 'ization', '<|sep|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|bos|>', 'col', 'on', 'ization', '<|sep|>', '<|endoftext|>', '<|endoftext|>', '<|endoftext|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>']
[09/10/2021 13:42:38 - INFO - root] Attention mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
[09/10/2021 13:42:38 - INFO - root] Position: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
[09/10/2021 13:42:38 - INFO - root] Target: ['<|bos|>', 'Ġthe', 'Ġact', 'Ġof', 'Ġcolon', 'izing', 'Ġ;', 'Ġthe', 'Ġestablishment', 'Ġof', 'Ġcolonies', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>', '<|pad|>']
[09/10/2021 13:42:38 - INFO - root] Position: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
[09/10/2021 13:42:38 - INFO - root] Labels: ['Ġthe', 'Ġact', 'Ġof', 'Ġcolon', 'izing', 'Ġ;', 'Ġthe', 'Ġestablishment', 'Ġof', 'Ġcolonies', '<|endoftext|>']
[09/10/2021 13:42:38 - INFO - root] Gate labels: [-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1]
[09/10/2021 13:42:38 - INFO - root] ***** Running training *****
[09/10/2021 13:42:38 - INFO - root]   Num examples = 97855
[09/10/2021 13:42:38 - INFO - root]   Num Epochs = 3
[09/10/2021 13:42:38 - INFO - root]   Instantaneous batch size per GPU = 32
[09/10/2021 13:42:38 - INFO - root]   Total train batch size (w. parallel, distributed & accumulation) = 64
[09/10/2021 13:42:38 - INFO - root]   Gradient Accumulation steps = 1
[09/10/2021 13:42:38 - INFO - root]   Total optimization steps = 4587
source length: 110
Epoch:   0%|          | 0/3 [00:00<?, ?it/s]
Iteration:   0%|          | 0/1529 [00:00<?, ?it/s][A/home/work/soft/conda3/envs/multigen/lib/python3.7/site-packages/torch/nn/parallel/_functions.py:64: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
/home/work/ldw/multigen/scripts/optimization.py:165: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at  /opt/conda/conda-bld/pytorch_1603729006826/work/torch/csrc/utils/python_arg_parser.cpp:882.)
  exp_avg.mul_(beta1).add_(1.0 - beta1, grad)

Iteration:   0%|          | 1/1529 [00:20<8:47:21, 20.71s/it][A
Iteration:   0%|          | 2/1529 [00:21<3:50:06,  9.04s/it][A
Iteration:   0%|          | 3/1529 [00:22<2:15:00,  5.31s/it][A
Iteration:   0%|          | 4/1529 [00:23<1:30:22,  3.56s/it][A
Iteration:   0%|          | 5/1529 [00:24<1:05:41,  2.59s/it][A
Iteration:   0%|          | 6/1529 [00:25<50:50,  2.00s/it]  [A
Iteration:   0%|          | 7/1529 [00:25<41:30,  1.64s/it][A
Iteration:   1%|          | 8/1529 [00:29<59:09,  2.33s/it][A
Iteration:   1%|          | 9/1529 [00:30<47:32,  1.88s/it][A
Iteration:   1%|          | 10/1529 [00:31<39:37,  1.56s/it][A
Iteration:   1%|          | 11/1529 [00:32<34:12,  1.35s/it][A
Iteration:   1%|          | 12/1529 [00:33<30:28,  1.21s/it][A
Iteration:   1%|          | 13/1529 [00:34<27:54,  1.10s/it][A
Iteration:   1%|          | 14/1529 [00:34<26:07,  1.03s/it][A
Iteration:   1%|          | 15/1529 [00:40<57:22,  2.27s/it][A
Iteration:   1%|          | 16/1529 [00:41<46:46,  1.86s/it][A
Iteration:   1%|          | 17/1529 [00:41<39:16,  1.56s/it][A
Iteration:   1%|          | 18/1529 [00:42<34:02,  1.35s/it][A
Iteration:   1%|          | 19/1529 [00:43<30:22,  1.21s/it][A[09/10/2021 13:43:23 - INFO - root] Step: 20 | Loss: 9.4840 | Gen loss: 6.8319 | Gate Loss: 0.0219 | Triple Loss: 0.5701

Iteration:   1%|▏         | 20/1529 [00:44<27:51,  1.11s/it][A
Iteration:   1%|▏         | 21/1529 [00:45<26:03,  1.04s/it][A
Iteration:   1%|▏         | 22/1529 [00:52<1:10:42,  2.82s/it][A
Iteration:   2%|▏         | 23/1529 [00:53<56:00,  2.23s/it]  [A
Iteration:   2%|▏         | 24/1529 [00:54<45:44,  1.82s/it][A
Iteration:   2%|▏         | 25/1529 [00:54<38:31,  1.54s/it][A
Iteration:   2%|▏         | 26/1529 [00:55<33:29,  1.34s/it][A
Iteration:   2%|▏         | 27/1529 [00:56<29:58,  1.20s/it][A
Iteration:   2%|▏         | 28/1529 [00:57<27:31,  1.10s/it][A
Iteration:   2%|▏         | 29/1529 [01:03<1:02:48,  2.51s/it][A
Iteration:   2%|▏         | 30/1529 [01:04<50:26,  2.02s/it]  [A
Iteration:   2%|▏         | 31/1529 [01:05<41:50,  1.68s/it][A
Iteration:   2%|▏         | 32/1529 [01:05<35:46,  1.43s/it][A
Iteration:   2%|▏         | 33/1529 [01:06<31:30,  1.26s/it][A
Iteration:   2%|▏         | 34/1529 [01:07<28:33,  1.15s/it][A
Iteration:   2%|▏         | 35/1529 [01:08<26:28,  1.06s/it][A
Iteration:   2%|▏         | 36/1529 [01:13<53:06,  2.13s/it][A
Iteration:   2%|▏         | 37/1529 [01:14<43:45,  1.76s/it][A
Iteration:   2%|▏         | 38/1529 [01:14<37:09,  1.50s/it][A
Iteration:   3%|▎         | 39/1529 [01:15<32:27,  1.31s/it][A[09/10/2021 13:43:55 - INFO - root] Step: 40 | Loss: 6.6369 | Gen loss: 5.8560 | Gate Loss: 0.0119 | Triple Loss: 0.1626

Iteration:   3%|▎         | 40/1529 [01:16<29:11,  1.18s/it][A
Iteration:   3%|▎         | 41/1529 [01:17<26:52,  1.08s/it][A
Iteration:   3%|▎         | 42/1529 [01:18<25:16,  1.02s/it][A
Iteration:   3%|▎         | 43/1529 [01:24<1:05:39,  2.65s/it][A
Iteration:   3%|▎         | 44/1529 [01:25<52:22,  2.12s/it]  [A
Iteration:   3%|▎         | 45/1529 [01:26<43:06,  1.74s/it][A
Iteration:   3%|▎         | 46/1529 [01:27<36:38,  1.48s/it][A
Iteration:   3%|▎         | 47/1529 [01:28<32:05,  1.30s/it][A
Iteration:   3%|▎         | 48/1529 [01:29<28:54,  1.17s/it][A
Iteration:   3%|▎         | 49/1529 [01:30<26:40,  1.08s/it][A
Iteration:   3%|▎         | 50/1529 [01:36<1:03:08,  2.56s/it][A
Iteration:   3%|▎         | 51/1529 [01:37<50:37,  2.06s/it]  [A
Iteration:   3%|▎         | 52/1529 [01:37<41:51,  1.70s/it][A
Iteration:   3%|▎         | 53/1529 [01:38<35:42,  1.45s/it][A
Iteration:   4%|▎         | 54/1529 [01:39<31:23,  1.28s/it][A
Iteration:   4%|▎         | 55/1529 [01:40<28:22,  1.15s/it][A
Iteration:   4%|▎         | 56/1529 [01:41<26:17,  1.07s/it][A
Iteration:   4%|▎         | 57/1529 [01:47<1:02:17,  2.54s/it][A
Iteration:   4%|▍         | 58/1529 [01:48<49:58,  2.04s/it]  [A
Iteration:   4%|▍         | 59/1529 [01:49<41:22,  1.69s/it][A[09/10/2021 13:44:28 - INFO - root] Step: 60 | Loss: 5.6731 | Gen loss: 5.2786 | Gate Loss: 0.0206 | Triple Loss: 0.0864

Iteration:   4%|▍         | 60/1529 [01:49<35:21,  1.44s/it][A
Iteration:   4%|▍         | 61/1529 [01:50<31:08,  1.27s/it][A
Iteration:   4%|▍         | 62/1529 [01:51<28:10,  1.15s/it][A
Iteration:   4%|▍         | 63/1529 [01:52<26:06,  1.07s/it][A
Iteration:   4%|▍         | 64/1529 [01:59<1:05:40,  2.69s/it][A
Iteration:   4%|▍         | 65/1529 [01:59<52:18,  2.14s/it]  [A
Iteration:   4%|▍         | 66/1529 [02:00<42:57,  1.76s/it][A
Iteration:   4%|▍         | 67/1529 [02:01<36:25,  1.49s/it][A
Iteration:   4%|▍         | 68/1529 [02:02<31:50,  1.31s/it][A
Iteration:   5%|▍         | 69/1529 [02:03<28:37,  1.18s/it][A
Iteration:   5%|▍         | 70/1529 [02:04<26:22,  1.08s/it][A
Iteration:   5%|▍         | 71/1529 [02:10<1:02:50,  2.59s/it][A
Iteration:   5%|▍         | 72/1529 [02:11<50:17,  2.07s/it]  [A
Iteration:   5%|▍         | 73/1529 [02:12<41:30,  1.71s/it][A
Iteration:   5%|▍         | 74/1529 [02:12<35:21,  1.46s/it][A
Iteration:   5%|▍         | 75/1529 [02:13<31:06,  1.28s/it][A
Iteration:   5%|▍         | 76/1529 [02:14<28:06,  1.16s/it][A
Iteration:   5%|▌         | 77/1529 [02:15<26:00,  1.07s/it][A
Iteration:   5%|▌         | 78/1529 [02:21<58:31,  2.42s/it][A
Iteration:   5%|▌         | 79/1529 [02:22<47:16,  1.96s/it][A[09/10/2021 13:45:01 - INFO - root] Step: 80 | Loss: 5.1546 | Gen loss: 4.8646 | Gate Loss: 0.0139 | Triple Loss: 0.0518

Iteration:   5%|▌         | 80/1529 [02:22<39:23,  1.63s/it][A
Iteration:   5%|▌         | 81/1529 [02:23<33:52,  1.40s/it][A
Iteration:   5%|▌         | 82/1529 [02:24<30:00,  1.24s/it][A
Iteration:   5%|▌         | 83/1529 [02:25<27:17,  1.13s/it][A
Iteration:   5%|▌         | 84/1529 [02:26<25:24,  1.05s/it][A
Iteration:   6%|▌         | 85/1529 [02:30<50:40,  2.11s/it][A
Iteration:   6%|▌         | 86/1529 [02:31<41:50,  1.74s/it][A
Iteration:   6%|▌         | 87/1529 [02:32<35:33,  1.48s/it][A
Iteration:   6%|▌         | 88/1529 [02:33<31:08,  1.30s/it][A
Iteration:   6%|▌         | 89/1529 [02:34<28:03,  1.17s/it][A
Iteration:   6%|▌         | 90/1529 [02:35<25:55,  1.08s/it][A
Iteration:   6%|▌         | 91/1529 [02:36<24:26,  1.02s/it][A
Iteration:   6%|▌         | 92/1529 [02:41<58:17,  2.43s/it][A
Iteration:   6%|▌         | 93/1529 [02:42<47:05,  1.97s/it][A
Iteration:   6%|▌         | 94/1529 [02:43<39:12,  1.64s/it][A
Iteration:   6%|▌         | 95/1529 [02:44<33:41,  1.41s/it][A
Iteration:   6%|▋         | 96/1529 [02:45<29:49,  1.25s/it][A
Iteration:   6%|▋         | 97/1529 [02:46<27:06,  1.14s/it][A
Iteration:   6%|▋         | 98/1529 [02:47<25:12,  1.06s/it][A
Iteration:   6%|▋         | 99/1529 [02:52<58:10,  2.44s/it][A[09/10/2021 13:45:32 - INFO - root] Step: 100 | Loss: 4.8053 | Gen loss: 4.4706 | Gate Loss: 0.0170 | Triple Loss: 0.0516

Iteration:   7%|▋         | 100/1529 [02:53<46:56,  1.97s/it][A
Iteration:   7%|▋         | 101/1529 [02:54<39:04,  1.64s/it][A
Iteration:   7%|▋         | 102/1529 [02:55<33:33,  1.41s/it][A
Iteration:   7%|▋         | 103/1529 [02:56<29:41,  1.25s/it][A
Iteration:   7%|▋         | 104/1529 [02:57<27:00,  1.14s/it][A
Iteration:   7%|▋         | 105/1529 [02:58<25:07,  1.06s/it][A
Iteration:   7%|▋         | 106/1529 [03:04<1:01:37,  2.60s/it][A
Iteration:   7%|▋         | 107/1529 [03:05<49:19,  2.08s/it]  [A
Iteration:   7%|▋         | 108/1529 [03:06<40:41,  1.72s/it][A
Iteration:   7%|▋         | 109/1529 [03:06<34:39,  1.46s/it][A
Iteration:   7%|▋         | 110/1529 [03:07<30:26,  1.29s/it][A
Iteration:   7%|▋         | 111/1529 [03:08<27:30,  1.16s/it][A
Iteration:   7%|▋         | 112/1529 [03:09<25:24,  1.08s/it][A
Iteration:   7%|▋         | 113/1529 [03:14<54:23,  2.31s/it][A
Iteration:   7%|▋         | 114/1529 [03:15<44:13,  1.88s/it][A
Iteration:   8%|▊         | 115/1529 [03:16<37:23,  1.59s/it][A
Iteration:   8%|▊         | 116/1529 [03:17<32:20,  1.37s/it][A
Iteration:   8%|▊         | 117/1529 [03:18<28:45,  1.22s/it][A
Iteration:   8%|▊         | 118/1529 [03:19<26:14,  1.12s/it][A
Iteration:   8%|▊         | 119/1529 [03:19<24:29,  1.04s/it][A[09/10/2021 13:46:04 - INFO - root] Step: 120 | Loss: 4.5577 | Gen loss: 4.4357 | Gate Loss: 0.0158 | Triple Loss: 0.0468

Iteration:   8%|▊         | 120/1529 [03:25<59:02,  2.51s/it][A
Iteration:   8%|▊         | 121/1529 [03:26<47:26,  2.02s/it][A
Iteration:   8%|▊         | 122/1529 [03:27<39:19,  1.68s/it][A
Iteration:   8%|▊         | 123/1529 [03:28<33:38,  1.44s/it][A
Iteration:   8%|▊         | 124/1529 [03:29<29:41,  1.27s/it][A
Iteration:   8%|▊         | 125/1529 [03:30<26:54,  1.15s/it][A
Iteration:   8%|▊         | 126/1529 [03:31<24:57,  1.07s/it][A
Iteration:   8%|▊         | 127/1529 [03:36<52:47,  2.26s/it][A
Iteration:   8%|▊         | 128/1529 [03:37<43:01,  1.84s/it][A
Iteration:   8%|▊         | 129/1529 [03:37<36:10,  1.55s/it][A
Iteration:   9%|▊         | 130/1529 [03:38<31:27,  1.35s/it][A
Iteration:   9%|▊         | 131/1529 [03:39<28:06,  1.21s/it][A
Iteration:   9%|▊         | 132/1529 [03:40<25:45,  1.11s/it][A
Iteration:   9%|▊         | 133/1529 [03:41<24:06,  1.04s/it][A
Iteration:   9%|▉         | 134/1529 [03:48<1:04:14,  2.76s/it][A
Iteration:   9%|▉         | 135/1529 [03:49<51:03,  2.20s/it]  [A
Iteration:   9%|▉         | 136/1529 [03:50<41:47,  1.80s/it][A
Iteration:   9%|▉         | 137/1529 [03:50<35:20,  1.52s/it][A
Iteration:   9%|▉         | 138/1529 [03:51<30:46,  1.33s/it][A
Iteration:   9%|▉         | 139/1529 [03:52<27:35,  1.19s/it][A[09/10/2021 13:46:32 - INFO - root] Step: 140 | Loss: 4.3916 | Gen loss: 4.2368 | Gate Loss: 0.0148 | Triple Loss: 0.0397

Iteration:   9%|▉         | 140/1529 [03:53<25:22,  1.10s/it][A
Iteration:   9%|▉         | 141/1529 [03:59<56:10,  2.43s/it][A
Iteration:   9%|▉         | 142/1529 [03:59<45:21,  1.96s/it][A
Iteration:   9%|▉         | 143/1529 [04:00<37:45,  1.63s/it][A
Iteration:   9%|▉         | 144/1529 [04:01<32:26,  1.41s/it][A
Iteration:   9%|▉         | 145/1529 [04:02<28:44,  1.25s/it][A
Iteration:  10%|▉         | 146/1529 [04:03<26:09,  1.13s/it][A
Iteration:  10%|▉         | 147/1529 [04:04<24:24,  1.06s/it][A
Iteration:  10%|▉         | 148/1529 [04:09<50:40,  2.20s/it][A
Iteration:  10%|▉         | 149/1529 [04:10<41:32,  1.81s/it][A
Iteration:  10%|▉         | 150/1529 [04:10<35:16,  1.53s/it][A
Iteration:  10%|▉         | 151/1529 [04:11<30:43,  1.34s/it][A
Iteration:  10%|▉         | 152/1529 [04:12<27:29,  1.20s/it][A
Iteration:  10%|█         | 153/1529 [04:13<25:13,  1.10s/it][A
Iteration:  10%|█         | 154/1529 [04:14<23:39,  1.03s/it][A
Iteration:  10%|█         | 155/1529 [04:19<51:38,  2.26s/it][A
Iteration:  10%|█         | 156/1529 [04:21<47:45,  2.09s/it][A
Iteration:  10%|█         | 157/1529 [04:22<39:22,  1.72s/it][A
Iteration:  10%|█         | 158/1529 [04:22<33:31,  1.47s/it][A
Iteration:  10%|█         | 159/1529 [04:23<29:27,  1.29s/it][A[09/10/2021 13:47:03 - INFO - root] Step: 160 | Loss: 4.2248 | Gen loss: 4.0658 | Gate Loss: 0.0149 | Triple Loss: 0.0404

Iteration:  10%|█         | 160/1529 [04:24<26:32,  1.16s/it][A
Iteration:  11%|█         | 161/1529 [04:25<24:32,  1.08s/it][A
Iteration:  11%|█         | 162/1529 [04:30<52:52,  2.32s/it][A
Iteration:  11%|█         | 163/1529 [04:31<43:15,  1.90s/it][A
Iteration:  11%|█         | 164/1529 [04:33<42:52,  1.88s/it][A
Iteration:  11%|█         | 165/1529 [04:34<35:55,  1.58s/it][A
Iteration:  11%|█         | 166/1529 [04:35<31:04,  1.37s/it][A
Iteration:  11%|█         | 167/1529 [04:36<27:40,  1.22s/it][A
Iteration:  11%|█         | 168/1529 [04:37<25:18,  1.12s/it][A
Iteration:  11%|█         | 169/1529 [04:41<45:08,  1.99s/it][A
Iteration:  11%|█         | 170/1529 [04:42<43:14,  1.91s/it][A
Iteration:  11%|█         | 171/1529 [04:44<42:52,  1.89s/it][A
Iteration:  11%|█         | 172/1529 [04:45<35:52,  1.59s/it][A
Iteration:  11%|█▏        | 173/1529 [04:46<31:01,  1.37s/it][A
Iteration:  11%|█▏        | 174/1529 [04:47<27:36,  1.22s/it][A
Iteration:  11%|█▏        | 175/1529 [04:48<25:13,  1.12s/it][A
Iteration:  12%|█▏        | 176/1529 [04:52<46:28,  2.06s/it][A
Iteration:  12%|█▏        | 177/1529 [04:54<44:25,  1.97s/it][A
Iteration:  12%|█▏        | 178/1529 [04:55<42:46,  1.90s/it][A
Iteration:  12%|█▏        | 179/1529 [04:56<35:47,  1.59s/it][A[09/10/2021 13:47:36 - INFO - root] Step: 180 | Loss: 4.1330 | Gen loss: 3.9020 | Gate Loss: 0.0194 | Triple Loss: 0.0523

Iteration:  12%|█▏        | 180/1529 [04:57<30:54,  1.37s/it][A
Iteration:  12%|█▏        | 181/1529 [04:58<27:28,  1.22s/it][A
Iteration:  12%|█▏        | 182/1529 [04:59<25:05,  1.12s/it][A
Iteration:  12%|█▏        | 183/1529 [05:04<50:55,  2.27s/it][A
Iteration:  12%|█▏        | 184/1529 [05:06<48:04,  2.14s/it][A
Iteration:  12%|█▏        | 185/1529 [05:07<39:29,  1.76s/it][A
Iteration:  12%|█▏        | 186/1529 [05:07<33:28,  1.50s/it][A
Iteration:  12%|█▏        | 187/1529 [05:08<29:15,  1.31s/it][A
Iteration:  12%|█▏        | 188/1529 [05:09<26:21,  1.18s/it][A
Iteration:  12%|█▏        | 189/1529 [05:10<24:17,  1.09s/it][A
Iteration:  12%|█▏        | 190/1529 [05:16<55:57,  2.51s/it][A
Iteration:  12%|█▏        | 191/1529 [05:17<44:59,  2.02s/it][A
Iteration:  13%|█▎        | 192/1529 [05:18<37:21,  1.68s/it][A
Iteration:  13%|█▎        | 193/1529 [05:19<31:56,  1.43s/it][A
Iteration:  13%|█▎        | 194/1529 [05:19<28:09,  1.27s/it][A
Iteration:  13%|█▎        | 195/1529 [05:20<25:34,  1.15s/it][A
Iteration:  13%|█▎        | 196/1529 [05:21<23:45,  1.07s/it][A
Iteration:  13%|█▎        | 197/1529 [05:27<55:05,  2.48s/it][A
Iteration:  13%|█▎        | 198/1529 [05:28<44:22,  2.00s/it][A
Iteration:  13%|█▎        | 199/1529 [05:29<37:40,  1.70s/it][A[09/10/2021 13:48:08 - INFO - root] Step: 200 | Loss: 4.0980 | Gen loss: 3.7796 | Gate Loss: 0.0140 | Triple Loss: 0.0410

Iteration:  13%|█▎        | 200/1529 [05:30<32:09,  1.45s/it][A
Iteration:  13%|█▎        | 201/1529 [05:31<28:16,  1.28s/it][A
Iteration:  13%|█▎        | 202/1529 [05:31<25:34,  1.16s/it][A
Iteration:  13%|█▎        | 203/1529 [05:32<23:40,  1.07s/it][A
Iteration:  13%|█▎        | 204/1529 [05:39<1:00:38,  2.75s/it][A
Iteration:  13%|█▎        | 205/1529 [05:40<48:11,  2.18s/it]  [A
Iteration:  13%|█▎        | 206/1529 [05:41<39:32,  1.79s/it][A
Iteration:  14%|█▎        | 207/1529 [05:42<33:24,  1.52s/it][A
Iteration:  14%|█▎        | 208/1529 [05:42<29:06,  1.32s/it][A
Iteration:  14%|█▎        | 209/1529 [05:43<26:07,  1.19s/it][A
Iteration:  14%|█▎        | 210/1529 [05:44<24:02,  1.09s/it][A
Iteration:  14%|█▍        | 211/1529 [05:50<55:32,  2.53s/it][A
Iteration:  14%|█▍        | 212/1529 [05:51<44:40,  2.04s/it][A
Iteration:  14%|█▍        | 213/1529 [05:52<36:59,  1.69s/it][A
Iteration:  14%|█▍        | 214/1529 [05:53<31:36,  1.44s/it][A
Iteration:  14%|█▍        | 215/1529 [05:54<27:52,  1.27s/it][A
Iteration:  14%|█▍        | 216/1529 [05:54<25:14,  1.15s/it][A
Iteration:  14%|█▍        | 217/1529 [05:55<23:23,  1.07s/it][A
Iteration:  14%|█▍        | 218/1529 [06:00<49:07,  2.25s/it][A
Iteration:  14%|█▍        | 219/1529 [06:01<40:04,  1.84s/it][A[09/10/2021 13:48:41 - INFO - root] Step: 220 | Loss: 4.0222 | Gen loss: 4.0107 | Gate Loss: 0.0160 | Triple Loss: 0.0452

Iteration:  14%|█▍        | 220/1529 [06:02<34:04,  1.56s/it][A
Iteration:  14%|█▍        | 221/1529 [06:03<29:33,  1.36s/it][A
Iteration:  15%|█▍        | 222/1529 [06:04<26:22,  1.21s/it][A
Iteration:  15%|█▍        | 223/1529 [06:05<24:08,  1.11s/it][A
Iteration:  15%|█▍        | 224/1529 [06:06<22:36,  1.04s/it][A
Iteration:  15%|█▍        | 225/1529 [06:13<1:01:24,  2.83s/it][A
Iteration:  15%|█▍        | 226/1529 [06:13<48:38,  2.24s/it]  [A
Iteration:  15%|█▍        | 227/1529 [06:14<39:43,  1.83s/it][A
Iteration:  15%|█▍        | 228/1529 [06:15<33:27,  1.54s/it][A
Iteration:  15%|█▍        | 229/1529 [06:16<29:02,  1.34s/it][A
Iteration:  15%|█▌        | 230/1529 [06:17<25:58,  1.20s/it][A
Iteration:  15%|█▌        | 231/1529 [06:18<23:51,  1.10s/it][A
Iteration:  15%|█▌        | 232/1529 [06:24<54:38,  2.53s/it][A
Iteration:  15%|█▌        | 233/1529 [06:25<43:52,  2.03s/it][A
Iteration:  15%|█▌        | 234/1529 [06:25<36:19,  1.68s/it][A
Iteration:  15%|█▌        | 235/1529 [06:26<31:02,  1.44s/it][A
Iteration:  15%|█▌        | 236/1529 [06:27<27:21,  1.27s/it][A
Iteration:  16%|█▌        | 237/1529 [06:28<24:46,  1.15s/it][A
Iteration:  16%|█▌        | 238/1529 [06:29<23:00,  1.07s/it][A
Iteration:  16%|█▌        | 239/1529 [06:35<53:28,  2.49s/it][A[09/10/2021 13:49:14 - INFO - root] Step: 240 | Loss: 3.9901 | Gen loss: 3.8720 | Gate Loss: 0.0157 | Triple Loss: 0.0424

Iteration:  16%|█▌        | 240/1529 [06:36<43:06,  2.01s/it][A
Iteration:  16%|█▌        | 241/1529 [06:37<35:45,  1.67s/it][A
Iteration:  16%|█▌        | 242/1529 [06:37<30:37,  1.43s/it][A
Iteration:  16%|█▌        | 243/1529 [06:38<27:02,  1.26s/it][A
Iteration:  16%|█▌        | 244/1529 [06:39<24:31,  1.15s/it][A
Iteration:  16%|█▌        | 245/1529 [06:40<22:45,  1.06s/it][A
Iteration:  16%|█▌        | 246/1529 [06:45<49:55,  2.33s/it][A
Iteration:  16%|█▌        | 247/1529 [06:46<40:33,  1.90s/it][A
Iteration:  16%|█▌        | 248/1529 [06:47<33:56,  1.59s/it][A
Iteration:  16%|█▋        | 249/1529 [06:48<29:19,  1.37s/it][A
Iteration:  16%|█▋        | 250/1529 [06:49<26:05,  1.22s/it][A
Iteration:  16%|█▋        | 251/1529 [06:50<23:57,  1.12s/it][A
Iteration:  16%|█▋        | 252/1529 [06:51<22:18,  1.05s/it][A
Iteration:  17%|█▋        | 253/1529 [06:56<53:06,  2.50s/it][A
Iteration:  17%|█▋        | 254/1529 [06:57<42:41,  2.01s/it][A
Iteration:  17%|█▋        | 255/1529 [06:58<35:25,  1.67s/it][A
Iteration:  17%|█▋        | 256/1529 [06:59<30:19,  1.43s/it][A
Iteration:  17%|█▋        | 257/1529 [07:00<26:47,  1.26s/it][A
Iteration:  17%|█▋        | 258/1529 [07:01<24:17,  1.15s/it][A
Iteration:  17%|█▋        | 259/1529 [07:02<22:35,  1.07s/it][A[09/10/2021 13:49:46 - INFO - root] Step: 260 | Loss: 3.9434 | Gen loss: 3.9059 | Gate Loss: 0.0167 | Triple Loss: 0.0558

Iteration:  17%|█▋        | 260/1529 [07:08<53:08,  2.51s/it][A
Iteration:  17%|█▋        | 261/1529 [07:08<42:44,  2.02s/it][A
Iteration:  17%|█▋        | 262/1529 [07:09<35:24,  1.68s/it][A
Iteration:  17%|█▋        | 263/1529 [07:10<30:16,  1.43s/it][A
Iteration:  17%|█▋        | 264/1529 [07:11<26:41,  1.27s/it][A
Iteration:  17%|█▋        | 265/1529 [07:12<24:11,  1.15s/it][A
Iteration:  17%|█▋        | 266/1529 [07:13<22:29,  1.07s/it][A
Iteration:  17%|█▋        | 267/1529 [07:19<53:37,  2.55s/it][A
Iteration:  18%|█▊        | 268/1529 [07:20<43:01,  2.05s/it][A
Iteration:  18%|█▊        | 269/1529 [07:21<35:34,  1.69s/it][A
Iteration:  18%|█▊        | 270/1529 [07:21<30:21,  1.45s/it][A
Iteration:  18%|█▊        | 271/1529 [07:22<26:43,  1.27s/it][A
Iteration:  18%|█▊        | 272/1529 [07:23<24:11,  1.15s/it][A
Iteration:  18%|█▊        | 273/1529 [07:24<22:23,  1.07s/it][A
Iteration:  18%|█▊        | 274/1529 [07:30<51:29,  2.46s/it][A
Iteration:  18%|█▊        | 275/1529 [07:31<41:30,  1.99s/it][A
Iteration:  18%|█▊        | 276/1529 [07:32<34:29,  1.65s/it][A
Iteration:  18%|█▊        | 277/1529 [07:32<29:35,  1.42s/it][A
Iteration:  18%|█▊        | 278/1529 [07:33<26:08,  1.25s/it][A
Iteration:  18%|█▊        | 279/1529 [07:34<23:43,  1.14s/it][A[09/10/2021 13:50:14 - INFO - root] Step: 280 | Loss: 3.8713 | Gen loss: 3.9328 | Gate Loss: 0.0119 | Triple Loss: 0.0338

Iteration:  18%|█▊        | 280/1529 [07:35<22:03,  1.06s/it][A
Iteration:  18%|█▊        | 281/1529 [07:41<53:32,  2.57s/it][A
Iteration:  18%|█▊        | 282/1529 [07:42<42:53,  2.06s/it][A
Iteration:  19%|█▊        | 283/1529 [07:43<35:25,  1.71s/it][A./train.sh: line 33: 136834 Killed                  CUDA_VISIBLE_DEVICES=${DEVICE} python3 main.py --train_data_file ${ROOT_PATH}/data/${DATA_TYPE}/train --dev_data_file ${ROOT_PATH}/data/${DATA_TYPE}/dev --test_data_file ${ROOT_PATH}/data/${DATA_TYPE}/test --graph_path 2hops_100_directed_triple_filter.json --output_dir ${ROOT_PATH}/models/${DATA_TYPE}/grf-${DATA_TYPE} --source_length 110 --target_length 110 --model_type gpt2 --model_name_or_path ${ROOT_PATH}/models/gpt2-small --do_train --per_gpu_train_batch_size 32 --per_gpu_eval_batch_size 32 --workers 7 --seed 42 --evaluate_metrics bleu --overwrite_output_dir --num_train_epochs 3 --learning_rate 1e-5 --aggregate_method max --alpha 3 --beta 5 --gamma 0.5 --weight_decay 0.0 --warmup_ratio 0.0 --logging_steps 20 --validate_steps 700
